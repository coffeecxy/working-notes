# intel-x86

以前学习微机原理的时候,学习的是arm相关的内容,但是现在没有在做嵌入式相关的东西,而是在研究linux在x86上面的东西,所以还需要补一些知识.


## x86处理器的寻址机制
intel在设计x86处理器的时候,其一个重要的准则就是要保持兼容性,从最开始的8086一直到后面的386以及后面的奔腾系列,他们都是向前兼容的.

真是因为这个兼容的要求,导致了在x86中有很多寻址方式.也就是逻辑地址,线性地址,物理地址.

1. 逻辑地址,就是在编写应用程序的时候,as汇编中指定的地址,x86中使用段加偏移的方式来得到这个地址.
2. 线性地址,应用程序要访问的逻辑地址会计算处一个线性地址,这是操作系统中使用的???
3. 物理地址,这是物理内存的地址.

x86的分段机制是要处理逻辑地址到线性地址的转换,分页机制处理线性地址到物理地址的转换.

在linux中,通过特殊的处理,直接让逻辑地址和线性地址一一对应了,其主要是使用分页机制来处理线性地址到物理地址的转换.

在DOS中,其没有使用分页机制,也就是线性地址就是物理地址,其只是使用了分段机制.

CR0中的PE和PG位会控制CPU运行的模式.

PE=0,PG=X,处理器运行于实模式,此时CPU只有1M的内存访问空间,这是一种为了兼容8086设计缺陷而使用的模式,现在的操作系统不会使用这种模式了. 但是CPU在启动的时候默认是处于这个模式的,而且操作系统启动的时候也是处于这个模式,在进行了一定的初始化之后,才会进入到后面的模式.

PE=1,PG=0,处理器运行与保护模式,但是没有启用分页机制,分段机制保证其可以访问到地址总线的所有空间.而且线性地址直接就是物理地址. 在DOS中使用的这个模式,因为DOS是一个单用户,单进程的系统,所以这个模式完全够用了.

PE=1,PG=1,处理器运行于保护模式,启用了分页机制,这个是现代操作系统都会使用的运行模式. 比如linux,其为一个多进程的系统,每个进程都认为自己有4g的内存空间可以使用,分页机制可以保证这个特性能得到满足.

> 我们经常说,Linux是一种多用户,多进程的操作系统,十分的先进,实际上,Linux能够做到如此的先进,是直接依赖于intel设计的x86处理器的. 如果x86没有提供这些功能,那么linux就要完全自己实现这些功能,可以想象,得到的操作系统的多进程特性会很差.
