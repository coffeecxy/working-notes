# system-boot

系统启动过程我们一般都不会太注意,但是其实际上是系统要运行起来的很重要的一个地方.


## bios
计算机开机启动之后,会有一个复位电路导致CPU复位,CPU复位之后,处于**实模式**下. 实模式下,存储器单元中有两部分是保留的. 一部分是00000h-003ffh,其为中断向量表,每个中需要4B的跳转地址,所以一共可以存下256个中断向量.
此时,其cs:ip会指向一个特定的物理地址,fffffff0h,一般的,这地方是主板上的一块ROM,这个地址也是保留的,这块ROM中存储一些特定的中断处理程序,其可以完成基本的对外设,特别是硬盘的输入输出功能,所以起被称为BIOS.

像dos这种只工作在实模式下的系统,其大部分的系统调用就直接使用了bios提供的功能. 但是linux工作在保护模式下,其工作的时候不会再使用bios提供的这些功能,而是全部自己实现了.

bios工作的时候,会完成下面的一些事情
1. 对计算机进行测试,检测硬件的可用性,也就是post,上电自检操作
2. 对这些硬件设备进行一些初始化,后面操作系统可以直接使用这些初始化好的硬件,或者是从新按照自己的要求出事化硬件设备.
3. 搜索一个操作系统来启动,这个是我们改变bios最多的地方,操作系统一般放在一个硬盘,软盘,u盘上面.
4. 把操作系统所在的那个硬件设备的第一个扇区,512B的内容读入到内存的7c00h(31k)处.然后让cpu跳转到7c00h处去执行.

实际上,上的最后一步,很有可能就是使用的bios提供的中断例程,因为bios会在0h-3ffh处建立一个中断向量表起来,其中就有处理从磁盘读取数据到内存的中断.

从磁盘上读进来的512B的内容,就是操作系统要启动起来的代码.这512B的内容会用汇编来写,而且完成的任务一般都是将操作系统**内核的启动代码**读到内存中的特定位置,然后去执行这启动代码. 因为512B的内容(实际上只有446B是程序,其他的是分区表)完全不能让一个操作系统起来.


## 参考文献
1. 深入理解linux内核,附录1,系统启动
2. 386系列数据手册


