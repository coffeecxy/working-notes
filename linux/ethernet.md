# 以太网

## 常用的网络设备

作为有线局域网事实上的标准,以太网是我们现在用得非常多的局域的形式.而且市面上的网卡大部分都是以太网卡,各种网络中间的设备也大部分是以太网设备.

以太网是IEEE 802.3这一组协议规定的.在TCP/IP协议协议栈中,其规定了物理层和链路层,我们最关心的还是起链路层的规定,因为其中有一个MAC协议.

传统的,以太网进行数据传输的时候,其是使用组侦的方式,就是将要传输的,数据组成一个一个的frame,每个frame的大小都是有规定的.传输的时候,需要遵守CSMA/CD协议,就是不断的监听共享的链路上面是不是没有数据在传输,如果是的话,那么就发送数据.这就很有可能会同时有几个接口都发送了数据,这个时候就会发送碰撞,这种碰撞是可以被检测到的,如果发生了碰撞,那么这些接口就会使用随机回退的方式,等待一定的时间再发送数据.

以太网的这种工作方式有一个问题,就是当共享链路上面有很多的接口的时候,基本上就不能正常的发送数据了,因为总是可能会发生碰撞.

为了解决这个问题,有如下的三种常用的以太网设备(不是以太网接口)

### hub
最简单的就是一个hub,也就是集线器

![](hub.svg)

其图示如上,因为我们使用的双绞线只有两个头,集线器就将所有一个LAN中的接口连接到一起来,但是我可以认为他是透明的,因为起会将接收到的任何一个包都从每一个头转发出去.所以在很大的LAN中使用集线器,这个LAN上面跑的包很多,但是其中有用的包并不多.比如上图中,p1要发送一个包到p6,集线器在收到p1传过来的包之后,会将其从p2-p6的每个头发出去,但是这些包在到达p2-p5的时候,因为这些包的目的MAC地址不是他们,所以会被丢弃.

### bridge

![](bridge.svg)

bridge比hub复杂了一些,其只有两个接口,可以将LAN中的接口分为两组,从一个组中的一个接口出来的包,如果其目的地址不是另一个组的,那么这包就不会被发到另外一个组中去.这样基本可以减少LAN中一半不需要被转发的包.

### switch
![](switch.svg)

switch比bridge更进了一步.LAN中的每个接口都会连接到switch上面,switch只会将包转发到目的接口,其他的接口都不会转发.比如p1要发送一个数据到p6,那么数据从p1来到switch后,switch只会将这个包从连接到p6的那个接口发出去,其他的接口都不会发.这样LAN中跑的包基本都是必须要的了.

当然,对于那些目的地址是broadcast的包,switch也会将这个包从每个接口转发出去.

以前大量的使用hub和bridge是因为switch的制造成本比较高,但是现在switch的制造成本下来了,所以现在switch(交换机)在LAN中是普遍存在的.
